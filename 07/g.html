<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Lets wrap this up, Ada · Unfiltered</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='website'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/warnOldVersion.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<script type="text/javascript" src="../js/snippets.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Unfiltered
</a>
<div class="version-number">
0.12.0
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../01.html" class="page">Try Unfiltered</a></li>
  <li><a href="../02.html" class="page">Plans and Intents</a></li>
  <li><a href="../03.html" class="page">Bindings and Servers</a></li>
  <li><a href="../04.html" class="page">Project Setup</a></li>
  <li><a href="../05.html" class="page">Community</a></li>
  <li><a href="../06/00.html" class="page">Matching and Responding</a>
  <ul>
    <li><a href="../06/a.html" class="page">Request Matchers</a></li>
    <li><a href="../06/b.html" class="page">Within the Parameters</a></li>
    <li><a href="../06/c.html" class="page">Response Functions</a></li>
    <li><a href="../06/d.html" class="page">Silly Store</a></li>
  </ul></li>
  <li><a href="../07/00.html" class="page">Directives and Validation</a>
  <ul>
    <li><a href="../07/a.html" class="page">Directive Intent</a></li>
    <li><a href="../07/b.html" class="page">Parameters as Directives</a></li>
    <li><a href="../07/c.html" class="page">Interpreter Reuse and Implicits</a></li>
    <li><a href="../07/d.html" class="page">Required Parameters</a></li>
    <li><a href="../07/e.html" class="page">Independent Failure</a></li>
    <li><a href="../07/f.html" class="page">Interpreters of Your Own Design</a></li>
    <li><a href="../07/g.html" class="active page">Let&rsquo;s wrap this up, Ada</a></li>
  </ul></li>
  <li><a href="../08/00.html" class="page">Application Structure</a>
  <ul>
    <li><a href="../08/a.html" class="page">Planning for Any-thing</a></li>
    <li><a href="../08/b.html" class="page">Just Kitting</a></li>
  </ul></li>
  <li><a href="../09/00.html" class="page">Identification and Cookies</a>
  <ul>
    <li><a href="../09/a.html" class="page">Who&rsquo;s Who</a></li>
    <li><a href="../09/b.html" class="page">Remembrance of Things Past</a></li>
  </ul></li>
  <li><a href="../10/00.html" class="page">Netty Plans</a>
  <ul>
    <li><a href="../10/a.html" class="page">Trying Netty</a></li>
    <li><a href="../10/b.html" class="page">Execution and Exceptions</a></li>
    <li><a href="../10/c.html" class="page">Chunked Requests</a></li>
    <li><a href="../10/d.html" class="page">Going Asynchronous</a></li>
    <li><a href="../10/e.html" class="page">Asyncrazy Temperature Server</a></li>
  </ul></li>
  <li><a href="../11.html" class="page">Jetty Extras</a></li>
  <li><a href="../12.html" class="page">ScalaTest</a></li>
  <li><a href="../99.html" class="page">Who&rsquo;s Using Unfiltered?</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="../index.html">Unfiltered</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Unfiltered
</a>
<div class="version-number">
0.12.0
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../01.html" class="page">Try Unfiltered</a></li>
  <li><a href="../02.html" class="page">Plans and Intents</a></li>
  <li><a href="../03.html" class="page">Bindings and Servers</a></li>
  <li><a href="../04.html" class="page">Project Setup</a></li>
  <li><a href="../05.html" class="page">Community</a></li>
  <li><a href="../06/00.html" class="page">Matching and Responding</a>
  <ul>
    <li><a href="../06/a.html" class="page">Request Matchers</a></li>
    <li><a href="../06/b.html" class="page">Within the Parameters</a></li>
    <li><a href="../06/c.html" class="page">Response Functions</a></li>
    <li><a href="../06/d.html" class="page">Silly Store</a></li>
  </ul></li>
  <li><a href="../07/00.html" class="page">Directives and Validation</a>
  <ul>
    <li><a href="../07/a.html" class="page">Directive Intent</a></li>
    <li><a href="../07/b.html" class="page">Parameters as Directives</a></li>
    <li><a href="../07/c.html" class="page">Interpreter Reuse and Implicits</a></li>
    <li><a href="../07/d.html" class="page">Required Parameters</a></li>
    <li><a href="../07/e.html" class="page">Independent Failure</a></li>
    <li><a href="../07/f.html" class="page">Interpreters of Your Own Design</a></li>
    <li><a href="../07/g.html" class="active page">Let&rsquo;s wrap this up, Ada</a></li>
  </ul></li>
  <li><a href="../08/00.html" class="page">Application Structure</a>
  <ul>
    <li><a href="../08/a.html" class="page">Planning for Any-thing</a></li>
    <li><a href="../08/b.html" class="page">Just Kitting</a></li>
  </ul></li>
  <li><a href="../09/00.html" class="page">Identification and Cookies</a>
  <ul>
    <li><a href="../09/a.html" class="page">Who&rsquo;s Who</a></li>
    <li><a href="../09/b.html" class="page">Remembrance of Things Past</a></li>
  </ul></li>
  <li><a href="../10/00.html" class="page">Netty Plans</a>
  <ul>
    <li><a href="../10/a.html" class="page">Trying Netty</a></li>
    <li><a href="../10/b.html" class="page">Execution and Exceptions</a></li>
    <li><a href="../10/c.html" class="page">Chunked Requests</a></li>
    <li><a href="../10/d.html" class="page">Going Asynchronous</a></li>
    <li><a href="../10/e.html" class="page">Asyncrazy Temperature Server</a></li>
  </ul></li>
  <li><a href="../11.html" class="page">Jetty Extras</a></li>
  <li><a href="../12.html" class="page">ScalaTest</a></li>
  <li><a href="../99.html" class="page">Who&rsquo;s Using Unfiltered?</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<span id="version-warning"></span>

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Unfiltered</a></li>
  <li><a href="../07/00.html">Directives and Validation</a></li>
  <li>Let&rsquo;s wrap this up, Ada</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h2><a href="#lets-wrap-this-up-ada" name="lets-wrap-this-up-ada" class="anchor"><span class="anchor-link"></span></a>Let&rsquo;s wrap this up, Ada</h2>
<p>We&rsquo;ve seen how to use directives in general, and how to use interpreters to make our own parameter directives, and even how to make our own interpreters. Our closing example will be one that you&rsquo;ve had with you all along: the default Unfiltered giter8 template.</p>
<h3><a href="#setting-up-the-template" name="setting-up-the-template" class="anchor"><span class="anchor-link"></span></a>Setting up the Template</h3>
<p>If you don&rsquo;t have the template project already, skip <a href="../01.html">back to the beginning</a> and follow the directions up until the <em>Consoled</em> section.</p>
<p>Instead of entering a Scala console this time, we want to examine and use the Scala sources included in the project. Go ahead and compile and run them:</p>
<pre class="prettyprint"><code class="language-sh">sbt run
</code></pre>
<p>The main class in the project will start an HTTP server on some available port, and it will attempt to open the root document on that server in your default browser. If you see a big ugly form, you&rsquo;re all set.</p>
<h3><a href="#understanding-the-source" name="understanding-the-source" class="anchor"><span class="anchor-link"></span></a>Understanding the Source</h3>
<p>Take a look at the source for the server, located here:</p>
<pre><code>src/main/scala/Example.scala
</code></pre>
<p>You should be able to understand most of what&rsquo;s happening, but there are a few things worth mentioning. Unlike previous examples in this chapter, this is a web server intended for browser clients. Our output is HTML and our input for the POST is a form serialized by the browser.</p>
<p>A simple <code>view</code> function is defined for displaying the page in both its initial, error, and success states. The function takes a map of parameters so that it can serve back the form inputs exactly as they were submitted, without being affected by any interpreters. We can get this separately from our parameter directives, using the trusty old <code>Params</code> extractor.</p><div class="callout note "><div class="callout-title">Note</div>
<p>Since we&rsquo;re just calling out snippets of the code, you won&rsquo;t be able to copy and paste these into a console as you can with most sections of this documentation. Feel free to play around with the template project source though, that&rsquo;s what it&rsquo;s there for.</p></div>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><code class="language-scala">case POST(Params(params)) =&gt;
  case class BadParam(msg: String)
  extends ResponseJoiner(msg)( messages =&gt;
    view(params)(&lt;ul&gt;{
      for (message &lt;- messages)
      yield &lt;li&gt;{message}&lt;/li&gt;
    }&lt;/ul&gt;)
  )</code></pre>
<p>Also worth noting is that we defined our <code>BadParam</code> case class inside the match expression, since it needs a reference to <code>params</code> to build its error response. Another option would have been to take the <code>params</code> as a constructor parameter for the class.</p>
<p>Finally, since we&rsquo;re dealing with user input via a serialized form rather than a programmatic web service, our expectations for errors are different. An &ldquo;empty&rdquo; field in the form is still submitted as a parameter &ndash; an empty string. Since this will be a common user error, we should handle it much like we would if the parameter were not submitted at all.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><code class="language-scala">val inputString = data.as.String ~&gt;
  data.as.String.trimmed ~&gt;
  data.as.String.nonEmpty.fail(
    (key, _) =&gt; BadParam(s&quot;$key is empty&quot;)
  )</code></pre>
<p>But of course, we still need to define a <code>required</code> function since it is possible that some client will fail to submit a parameter.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><code class="language-scala">implicit def required[T] = data.Requiring[T].fail(name =&gt;
  BadParam(name + &quot; is missing&quot;)
)</code></pre>
<p>Finally, in this case the code keeps the logic of the conditional interpreter separate from the implementation, which is inline.</p>
<pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><code class="language-scala">(inputString ~&gt; data.Conditional(palindrome).fail(
  (_, value) =&gt; BadParam(s&quot;&#39;$value&#39; is not a palindrome&quot;)
) ~&gt; required named &quot;palindrome&quot;)

def palindrome(s: String) =
  s.toLowerCase.reverse == s.toLowerCase</code></pre>
<p>This is just to show the variety of what&rsquo;s possible, it&rsquo;s up to you to decide how to organize and apply your own interpreters. Good luck, and don&rsquo;t be shy about contributing back interpreters of standard library types back into the Unfiltered directives source!</p>
<div class="nav-next">
<p><strong>Next:</strong> <a href="../08/00.html">Application Structure</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../07/g.html#lets-wrap-this-up-ada" class="header">Let&rsquo;s wrap this up, Ada</a>
  <ul>
    <li><a href="../07/g.html#setting-up-the-template" class="header">Setting up the Template</a></li>
    <li><a href="../07/g.html#understanding-the-source" class="header">Understanding the Source</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2023</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript">jQuery(function(jq){initOldVersionWarnings(jq, '0.12.0', '')});</script>


</html>
